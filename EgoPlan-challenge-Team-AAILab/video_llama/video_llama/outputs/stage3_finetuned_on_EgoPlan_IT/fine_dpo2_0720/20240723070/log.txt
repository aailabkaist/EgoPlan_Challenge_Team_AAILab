{
    "run": {
        "task": "video_text_pretrain",
        "lr_sched": "linear_warmup_cosine_lr",
        "init_lr": 3e-05,
        "min_lr": 1e-05,
        "warmup_lr": 1e-06,
        "weight_decay": 0.05,
        "max_epoch": 10,
        "iters_per_epoch": 3000,
        "batch_size_train": 2,
        "batch_size_eval": 4,
        "num_workers": 4,
        "warmup_steps": 1000,
        "seed": 42,
        "output_dir": "outputs/stage3_finetuned_on_EgoPlan_IT/fine_dpo2_0720",
        "amp": true,
        "resume_ckpt_path": null,
        "evaluate": false,
        "train_splits": [
            "train"
        ],
        "device": "cuda",
        "world_size": 1,
        "dist_url": "env://",
        "distributed": true,
        "rank": 0,
        "gpu": 0,
        "dist_backend": "nccl"
    },
    "model": {
        "arch": "egoplan_video_llama_dpo",
        "image_size": 224,
        "drop_path_rate": 0,
        "use_grad_checkpoint": false,
        "vit_precision": "fp16",
        "freeze_vit": true,
        "freeze_qformer": true,
        "num_query_token": 32,
        "llama_model": "/home/aailab/data2/kasong13/EgoPlan-challenge/Llama-2-7b-chat-hf",
        "prompt": "",
        "model_type": "pretrain_llama_v2",
        "use_DPO": true,
        "DPO_loss_only": true,
        "beta_DPO": 0.1,
        "vit_model_path": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/models/eva_vit_g.pth",
        "q_former_model": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/models/blip2_pretrained_flant5xxl.pth",
        "q_former_encoder_model": "/home/aailab/data2/kasong13/EgoPlan-challenge/bert-base-uncased",
        "ckpt": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/outputs/stage3_finetuned_on_EgoPlan_IT/orig_dpo/20240613193/checkpoint_9.pth",
        "llm_lora_config": {
            "lora_ckpt": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/outputs/stage3_finetuned_on_EgoPlan_IT/orig_dpo/20240613193/lora_weights_9",
            "use_lora": true,
            "is_trainable": true,
            "lora_r": 16,
            "lora_alpha": 32,
            "lora_dropout": 0.05,
            "lora_target_modules": [
                "q_proj",
                "k_proj",
                "v_proj",
                "o_proj"
            ]
        },
        "equip_audio_branch": false,
        "frozen_llama_proj": false,
        "frozen_video_Qformer": false,
        "frozen_audio_Qformer": true,
        "fusion_head_layers": 2,
        "max_frame_pos": 32,
        "fusion_header_type": "seqTransf",
        "max_txt_len": 320,
        "end_sym": "</s>",
        "prompt_path": "prompts/alignment_image.txt",
        "prompt_template": "[INST] <<SYS>>\\n \\n<</SYS>>\\n\\n{} [/INST] "
    },
    "preprocess": {
        "vis_processor": {
            "train": {
                "name": "alpro_video_train",
                "image_size": 224,
                "n_frms": 8
            },
            "eval": {
                "name": "alpro_video_eval",
                "image_size": 224,
                "n_frms": 8
            }
        },
        "text_processor": {
            "train": {
                "name": "blip_caption"
            },
            "eval": {
                "name": "blip_caption"
            }
        }
    },
    "datasets": {
        "egoplan_contrastive": {
            "data_type": "video",
            "build_info": {
                "anno_dir": "/home/aailab/data2/kasong13/EgoPlan-challenge/data/EgoPlan_IT.json",
                "videos_dir": "path/EPIC-KITCHENS/",
                "rgb_frame_dir": "/home/aailab/data4/kasong13/EPIC-KITCHENS"
            },
            "n_actions": 4,
            "answer_type": "egoplan_qa",
            "vis_processor": {
                "train": {
                    "name": "egoplan_video_train",
                    "n_frms": 8,
                    "image_size": 224
                }
            },
            "text_processor": {
                "train": {
                    "name": "blip_caption"
                }
            },
            "num_video_query_token": 32,
            "tokenizer_name": "/home/aailab/data2/kasong13/EgoPlan-challenge/Llama-2-7b-chat-hf",
            "model_type": "llama_v2"
        },
        "egoplan_action_recognition": {
            "data_type": "video",
            "build_info": {
                "anno_dir": "/home/aailab/data2/kasong13/EgoPlan-challenge/data/EgoPlan_IT.json",
                "videos_dir": "path/EPIC-KITCHENS/",
                "rgb_frame_dir": "/home/aailab/data4/kasong13/EPIC-KITCHENS"
            },
            "n_actions": 4,
            "answer_type": "egoplan_action_recognition",
            "vis_processor": {
                "train": {
                    "name": "egoplan_video_train",
                    "n_frms": 8,
                    "image_size": 224
                }
            },
            "text_processor": {
                "train": {
                    "name": "blip_caption"
                }
            },
            "num_video_query_token": 32,
            "tokenizer_name": "/home/aailab/data2/kasong13/EgoPlan-challenge/Llama-2-7b-chat-hf",
            "model_type": "llama_v2"
        },
        "cc_sbu_align": {
            "data_type": "images",
            "build_info": {
                "storage": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/configs/datasets/cc_sbu_align"
            },
            "vis_processor": {
                "train": {
                    "name": "blip2_image_train",
                    "image_size": 224
                }
            },
            "text_processor": {
                "train": {
                    "name": "blip_caption"
                }
            }
        },
        "llava_instruct": {
            "data_type": "images",
            "build_info": {
                "anno_dir": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/configs/datasets/llava_instruct_150k.json",
                "videos_dir": "/home/aailab/data3/SAIT/datasets/COCO/coco-image-dataset/train2014/"
            },
            "vis_processor": {
                "train": {
                    "name": "blip2_image_train",
                    "image_size": 224
                }
            },
            "text_processor": {
                "train": {
                    "name": "blip_caption"
                }
            },
            "num_video_query_token": 32,
            "tokenizer_name": "/home/aailab/data2/kasong13/EgoPlan-challenge/Llama-2-7b-chat-hf",
            "model_type": "llama_v2"
        },
        "webvid_instruct": {
            "data_type": "video",
            "build_info": {
                "anno_dir": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/configs/datasets/videochat_instruct_11k_remove_kh.json",
                "videos_dir": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/configs/datasets/webvid-10M/data/videos/"
            },
            "vis_processor": {
                "train": {
                    "name": "alpro_video_train",
                    "n_frms": 8,
                    "image_size": 224
                }
            },
            "text_processor": {
                "train": {
                    "name": "blip_caption"
                }
            },
            "num_video_query_token": 32,
            "tokenizer_name": "/home/aailab/data2/kasong13/EgoPlan-challenge/Llama-2-7b-chat-hf",
            "model_type": "llama_v2"
        }
    }
}
{
    "run": {
        "task": "video_text_pretrain",
        "lr_sched": "linear_warmup_cosine_lr",
        "init_lr": 3e-05,
        "min_lr": 1e-05,
        "warmup_lr": 1e-06,
        "weight_decay": 0.05,
        "max_epoch": 10,
        "iters_per_epoch": 3000,
        "batch_size_train": 2,
        "batch_size_eval": 4,
        "num_workers": 4,
        "warmup_steps": 1000,
        "seed": 42,
        "output_dir": "outputs/stage3_finetuned_on_EgoPlan_IT/fine_dpo2_0720",
        "amp": true,
        "resume_ckpt_path": null,
        "evaluate": false,
        "train_splits": [
            "train"
        ],
        "device": "cuda",
        "world_size": 1,
        "dist_url": "env://",
        "distributed": true,
        "rank": 0,
        "gpu": 0,
        "dist_backend": "nccl"
    },
    "model": {
        "arch": "egoplan_video_llama",
        "image_size": 224,
        "drop_path_rate": 0,
        "use_grad_checkpoint": false,
        "vit_precision": "fp16",
        "freeze_vit": true,
        "freeze_qformer": true,
        "num_query_token": 32,
        "llama_model": "/home/aailab/data2/kasong13/EgoPlan-challenge/Llama-2-7b-chat-hf",
        "prompt": "",
        "model_type": "pretrain_llama_v2",
        "use_DPO": true,
        "DPO_loss_only": true,
        "beta_DPO": 0.1,
        "vit_model_path": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/models/eva_vit_g.pth",
        "q_former_model": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/models/blip2_pretrained_flant5xxl.pth",
        "q_former_encoder_model": "/home/aailab/data2/kasong13/EgoPlan-challenge/bert-base-uncased",
        "ckpt": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/outputs/stage3_finetuned_on_EgoPlan_IT/orig_dpo/20240613193/checkpoint_9.pth",
        "llm_lora_config": {
            "lora_ckpt": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/outputs/stage3_finetuned_on_EgoPlan_IT/orig_dpo/20240613193/lora_weights_9",
            "use_lora": true,
            "is_trainable": true,
            "lora_r": 16,
            "lora_alpha": 32,
            "lora_dropout": 0.05,
            "lora_target_modules": [
                "q_proj",
                "k_proj",
                "v_proj",
                "o_proj"
            ]
        },
        "equip_audio_branch": false,
        "frozen_llama_proj": false,
        "frozen_video_Qformer": false,
        "frozen_audio_Qformer": true,
        "fusion_head_layers": 2,
        "max_frame_pos": 32,
        "fusion_header_type": "seqTransf",
        "max_txt_len": 320,
        "end_sym": "</s>",
        "prompt_path": "prompts/alignment_image.txt",
        "prompt_template": "[INST] <<SYS>>\\n \\n<</SYS>>\\n\\n{} [/INST] "
    },
    "preprocess": {
        "vis_processor": {
            "train": {
                "name": "alpro_video_train",
                "image_size": 224,
                "n_frms": 8
            },
            "eval": {
                "name": "alpro_video_eval",
                "image_size": 224,
                "n_frms": 8
            }
        },
        "text_processor": {
            "train": {
                "name": "blip_caption"
            },
            "eval": {
                "name": "blip_caption"
            }
        }
    },
    "datasets": {
        "egoplan_contrastive": {
            "data_type": "video",
            "build_info": {
                "anno_dir": "/home/aailab/data2/kasong13/EgoPlan-challenge/data/EgoPlan_IT.json",
                "videos_dir": "path/EPIC-KITCHENS/",
                "rgb_frame_dir": "/home/aailab/data4/kasong13/EPIC-KITCHENS"
            },
            "n_actions": 4,
            "answer_type": "egoplan_qa",
            "vis_processor": {
                "train": {
                    "name": "egoplan_video_train",
                    "n_frms": 8,
                    "image_size": 224
                }
            },
            "text_processor": {
                "train": {
                    "name": "blip_caption"
                }
            },
            "num_video_query_token": 32,
            "tokenizer_name": "/home/aailab/data2/kasong13/EgoPlan-challenge/Llama-2-7b-chat-hf",
            "model_type": "llama_v2"
        },
        "egoplan_action_recognition": {
            "data_type": "video",
            "build_info": {
                "anno_dir": "/home/aailab/data2/kasong13/EgoPlan-challenge/data/EgoPlan_IT.json",
                "videos_dir": "path/EPIC-KITCHENS/",
                "rgb_frame_dir": "/home/aailab/data4/kasong13/EPIC-KITCHENS"
            },
            "n_actions": 4,
            "answer_type": "egoplan_action_recognition",
            "vis_processor": {
                "train": {
                    "name": "egoplan_video_train",
                    "n_frms": 8,
                    "image_size": 224
                }
            },
            "text_processor": {
                "train": {
                    "name": "blip_caption"
                }
            },
            "num_video_query_token": 32,
            "tokenizer_name": "/home/aailab/data2/kasong13/EgoPlan-challenge/Llama-2-7b-chat-hf",
            "model_type": "llama_v2"
        },
        "cc_sbu_align": {
            "data_type": "images",
            "build_info": {
                "storage": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/configs/datasets/cc_sbu_align"
            },
            "vis_processor": {
                "train": {
                    "name": "blip2_image_train",
                    "image_size": 224
                }
            },
            "text_processor": {
                "train": {
                    "name": "blip_caption"
                }
            }
        },
        "llava_instruct": {
            "data_type": "images",
            "build_info": {
                "anno_dir": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/configs/datasets/llava_instruct_150k.json",
                "videos_dir": "/home/aailab/data3/SAIT/datasets/COCO/coco-image-dataset/train2014/"
            },
            "vis_processor": {
                "train": {
                    "name": "blip2_image_train",
                    "image_size": 224
                }
            },
            "text_processor": {
                "train": {
                    "name": "blip_caption"
                }
            },
            "num_video_query_token": 32,
            "tokenizer_name": "/home/aailab/data2/kasong13/EgoPlan-challenge/Llama-2-7b-chat-hf",
            "model_type": "llama_v2"
        },
        "webvid_instruct": {
            "data_type": "video",
            "build_info": {
                "anno_dir": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/configs/datasets/videochat_instruct_11k_remove_kh.json",
                "videos_dir": "/home/aailab/data2/kasong13/EgoPlan-challenge/src/video_llama/video_llama/configs/datasets/webvid-10M/data/videos/"
            },
            "vis_processor": {
                "train": {
                    "name": "alpro_video_train",
                    "n_frms": 8,
                    "image_size": 224
                }
            },
            "text_processor": {
                "train": {
                    "name": "blip_caption"
                }
            },
            "num_video_query_token": 32,
            "tokenizer_name": "/home/aailab/data2/kasong13/EgoPlan-challenge/Llama-2-7b-chat-hf",
            "model_type": "llama_v2"
        }
    }
}
